CHECKLIST = {
    "Установление контакта": {
        "1 Приветствие, знакомство": {
            "description": "Приветствие, знакомство. Озвучивание цели звонка.",
            "max": {"score": 1, "criterion": "Менеджер выполнил все пункты: 1.представися,2.назвал компанию, 3. обратился к клиенту по имени, 4.озвучил цель звонка(программирование)"},
            "mid": {"score": 0.5, "criterion": "Менеджер не выполнил один из пунктов: 1.не представися,2.не назвал компанию, 3.не обратился к клиенту по имени, 4.не озвучил цель звонка(программирование)"},
            "min": {"score": 0, "criterion": "Отсутствие приветствия, представления, обращения к клиену по имени."}
        }
    },
    "Квалификация": {
        "2 Первичная квалификация": {
            "description": "Провести первичную квалификацию клиента",
            "max": {"score": 1, "criterion": "Менеджер запросил у клиента наличие технической возможности проведения занятия."},
            "mid": {"score": 0.5, "criterion": "Информация про техническое обеспечение для занятия запрошена не в начале разговора."},
            "min": {"score": 0, "criterion": "Информация о техническом обеспечении занятия не запрошена."}
        }
    },
    "Выявление потребностей": {
        "3.1 Вопросы вторичной квалификации": {
            "description": "Выявить информация для вторичной квалификации клиентов",
            "max": {"score": 1, "criterion": "Менеджер задает вопросы для точного понимания потребности клиента в обучении. 1.Узнал, какое направление интересно ребенку? 2.Узнал, сколько лет ребенку? 3.Узнал, есть ли опыт в данном направлении, уже занималась (само направление)? 4.Узнал, был ли опыт занятий дистанционно?"},
            "mid": {"score": 0.5, "criterion": "Менеджер задал только 1-2 вопроса на ВП из строки для получения 1 балла"},
            "min": {"score": 0, "criterion": "Менеджер НЕ задал вопросы для выявления потребности, либо получил ответ клиента в следующей формулировке \"Просто интересно\", \"Пока просто изучаю\", \"Я на будущее\""}
        },
        "3.2 Вопрос о цели обучения": {
            "description": "Выявить причину обращения в Айтигенио, использовать полученную информацию для следующих этапов",
            "max": {"score": 1, "criterion": "Менеджер задает вопросы для понимания цели обучения. При затруднении клиента ответить на этот вопрос-помогает вспомогающими вопросами клиенту."},
            "mid": {"score": 0.5, "criterion": "Потребность осталась понята поверхностно"},
            "min": {"score": 0, "criterion": "Менеджер НЕ задал вопросы по цели на обучение"}
        },
        "3.3 Резюмирование потребности": {
            "description": "Подвести резюме по полученной информации от клиента",
            "max": {"score": 1, "criterion": "Резюмировал"},
            "mid": {"score": 0.5, "criterion": "нет"},
            "min": {"score": 0, "criterion": "Не резюмировал"}
        }
    },
    "Презентация": {
        "4.1 Презентация обучения из потребности клиента": {
            "description": "Создать ценность обучения индивидуально для клиента Показать клиенту, как обучение поможет именно ему или повлияет на его жизнь и жизнь его ребенка",
            "max": {"score": 1, "criterion": "Презентует обучение исходя из целя\\потребности клиента. менеджер делает отсылки к словам клиента и аргументирует свою рекомендацию. Озвучиваются результаты обучения.Есть информация о школе и то, как у нас можно реализовать цель клиента."},
            "mid": {"score": 0.5, "criterion": "нет"},
            "min": {"score": 0, "criterion": "Презентует обучение не из потребности клиента."}
        },
        "4.2 Презентация формата обучения": {
            "description": "Создать ценность обучения в онлайн формате и рассказать об отличительных чертах",
            "max": {"score": 1, "criterion": "Рассказал, почему именно выбранный формат (ИГФ, ИФ, ИФ30, ) идеально подходит под изучение направления и должен привести к хорошим результатам"},
            "mid": {"score": 0.5, "criterion": "Менеджер презентует формат обучения не полностью, либо не обозначает достоинства формата обучения. Если предлагается вариант ИФ, то обязательно рассказать про то, что стоимость таких уроков выше."},
            "min": {"score": 0, "criterion": "Менеджер не проводит презентацию формата обучения"}
        },
        "4.3 Презентация стоимости": {
            "description": "Данный пункт оценивается, если от клиента был получен запрос на стоимость обучения",
            "max": {"score": 1, "criterion": "Менеджер своевременно и обоснованно обсудил в диалоге тему стоимости и оплаты.Если клиент запрашивает информацию о цене-менеджер пытается отработать это возражение и озвучивает, почему стоимость занятий будет презентована после пробного урока. Если клиент настаивает на озвучивании стоимости, то менеджер знакомит клиента с ценой и формой оплаты.\n\nВажно:\n1. Озвучил стоимость за один урок от.... до..../акцент на средних пакетах 64\\32 занятий/абонементов.\n2. Сравнение пакетов (кол-ва уроков, на сколько хватит и оптовая скидка)\n3. Задал уточняющий вопрос, например:\n\"Что скажите?\"\n\"Какой пакет вам больше подходит?\"\nи тд."},
            "mid": {"score": 0.5, "criterion": "Менеджер сразу озвучивает информацию по стоимости после запроса клиента, без попытки отработки возражения.Менеждер неверно, либо не полностью проводит презентацию стоимости продукта. Не использует формат от большего к меньшему. Менеджер не создает выгоду и ценность продукта.\n\nВажно: озвучил до 2х пунтов из \"важно\" с баллом 1"},
            "min": {"score": 0, "criterion": "Менеждер не отрабатавает вопрос про стоимость от клиента и не предоставляет инфомацию о стоимости сам. Менеджер рассказывает про стоимость обучения без прямого вопроса от клиента."}
        },
        "4.4 Озвучивание информации для проведения пробного занятия": {
            "description": "Информирование клиента о необходимых условиях проведения пробного урока",
            "max": {"score": 1, "criterion": "Менеджер презентует клиенту обязательные бонусы и условия:\n\n1. Рассказал о технических условиях проведения пробного занятия\n2. Рассказал о порядке проведения урока  3.Рассказал об организационных моментов для проведения урока"},
            "mid": {"score": 0.5, "criterion": "нет"},
            "min": {"score": 0, "criterion": "Менеджер не озвучивает условия"}
        }
    },
    "Работа с возражениями": {
        "5 Уточнить сомнение клиента": {
            "description": "Уточнить сомнение клиента",
            "max": {"score": 1, "criterion": "Уточнил у клиента, есть ли возражения\nНапример:\n\"Возможно у вас остались вопросы, поделитесь пожалуйста, какие?\""},
            "mid": {"score": 0.5, "criterion": "нет"},
            "min": {"score": 0, "criterion": "Менеджер не стал уточнять возражения"}
        }
    },
    "Завершение сделки": {
        "6 Завершение сделки": {
            "description": "Структурировать все договоренности которых достигли в течении диалога, договориться о следующем контакте при необходимости, а также позитивно закончить диалог, чтобы оставить хорошее впечатление от работы с менеджером",
            "max": {"score": 1, "criterion": "Менеджер получил окончательное согласие от клиента, либо договорился о дате следующего контака для принятия решения. Подводит итог диалога (резюмирование). Заканчивает диалог на позитивной ноте."},
            "mid": {"score": 0.5, "criterion": "Менеджер позитивно завершает диалог, подводит итог, но не договаривается вообще или договаривается размыто о следущем контакте.\n\nНапример: \"Буду ждать Вашего решения \" или \"Буду ждать от вас ОС в WhatsApp\""},
            "min": {"score": 0, "criterion": "Финальных договоренностей нет, отсутствует резюмирование разговора с клиентом. Диалог заканчивается ничем, когда будет следующий контакт непонятно."}
        }
    },
    "Голосовые характеристики": {
        "7.1 Грамотность и формулировки": {
            "description": "Оценивается грамотность и формулировки в устной речи\n Используются правильные стилистические обороты, слова с правильными ударениями, смысл предложений понятен\n Все предложения согласованы, нет просторечий, правильные ударения в словах, нет слов-паразитов (переизбыток междометий «а», «эм», «ну»), жаргонизмов\n Нет уменьшительно-ласкательных суффиксов, исковерканных слов (кроме \"галочка\", \"звездочка\", \"черточка\", \"собачка\",\"секундочка\",\"Минутка\")\n Отсутствие скриптовости в речи (отсутствуют шаблонные скриптовые фразы)\n Отсутствие ненормативной лексики\n Отсутствуют долгие/необоснованные паузы в диалоге\nДоброжелательный тон разговора\n Эмпатия",
            "max": {"score": 1, "criterion": "Речь и эмоциональная окраска беседы соответствует заявленным пунктам в описании. Менеджер реагирует на слова клиента с эмпатией."},
            "mid": {"score": 0.5, "criterion": "Используются неправильные стилистические обороты, слова с неправильными ударениями, есть паузы в разговоре.\n Предложения не согласованы, присутствуют просторечия, жаргонизмы, слова-паразиты, уменьшительно-ласкательные слова. При необходимости-эмпатия со стороны менеджера не проявлена."},
            "min": {"score": 0, "criterion": "Незаинтересованность менеджера,грубость, перебивание клиента.\n Менеджер допускает использование ненормативной лексики в разговоре с клиентом\n Долгие паузы в разговоре\n В речи менеджера отмечаются большая часть заявленных нарушений."}
        },
        "7.2 Инициатива за ведение диалога": {
            "description": "Инициатива за ведение диалога",
            "max": {"score": 1, "criterion": "Менеджер ведет диалог и управляет им, задает вопросы, активно предлагает варианты"},
            "mid": {"score": 0.5, "criterion": "нет"},
            "min": {"score": 0, "criterion": "Инициатива за ведение диалога на стороне клиента"}
        }
    }
}

def get_checklist_prompt():
    prompt = "Ты - эксперт по оценке качества звонков менеджеров по продажам. "
    prompt += "Твоя задача - объективно и последовательно оценить звонок по строгим критериям.\n\n"
    prompt += "ПРАВИЛА ОЦЕНКИ:\n"
    prompt += "1. Оценивай ТОЛЬКО по фактам из транскрипции. Не добавляй предположений.\n"
    prompt += "2. Для каждого критерия проверь, выполнено ли описание этапа.\n"
    prompt += "3. Сравни выполнение с критериями MAX/МИД/МИН и выбери соответствующий балл.\n"
    prompt += "4. Если транскрипция идентична - результат ДОЛЖЕН быть идентичен.\n"
    prompt += "5. Используй только допустимые баллы: 0, 0.5 или 1.\n"
    prompt += "6. Будь строгим и объективным. Одинаковые действия = одинаковые баллы.\n\n"
    
    for stage_name, items in CHECKLIST.items():
        prompt += f"\n{stage_name}:\n"
        for item_key, item_data in items.items():
            prompt += f"\n{item_key}:\n"
            prompt += f"Описание: {item_data['description']}\n"
            if "max" in item_data:
                prompt += f"MAX ({item_data['max']['score']} баллов): {item_data['max']['criterion']}\n"
            if "mid" in item_data:
                prompt += f"МИД ({item_data['mid']['score']} баллов): {item_data['mid']['criterion']}\n"
            if "min" in item_data:
                prompt += f"МИН ({item_data['min']['score']} баллов): {item_data['min']['criterion']}\n"
    
    prompt += "\n\nВерни JSON в следующем формате:\n"
    prompt += "{\n"
    prompt += '  "1": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "2": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "3.1": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "3.2": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "3.3": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "4.1": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "4.2": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "4.3": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "4.4": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "5": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "6": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "7.1": {"score": число, "comment": "комментарий"},\n'
    prompt += '  "7.2": {"score": число, "comment": "комментарий"}\n'
    prompt += "}\n"
    prompt += "\nИспользуй только допустимые значения баллов: 0, 0.5 или 1."
    prompt += "\nДля пункта 4.3 (Презентация стоимости): оценивай этот пункт ТОЛЬКО если от клиента был получен запрос на стоимость обучения. Если запроса не было, не включай этот пункт в ответ."
    
    return prompt
