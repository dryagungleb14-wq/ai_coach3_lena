# Railway Troubleshooting Guide

## Основные проблемы и решения:

### 1. Приложение не запускается

**Проблема**: Railway не может запустить приложение

**Решение**:
- Убедитесь что Root Directory установлен как `backend`
- Проверьте что `railway.json` находится в папке `backend`
- Проверьте логи в Railway (View Logs)

### 2. Ошибка с портом

**Проблема**: `Address already in use` или порт не определен

**Решение**:
- Railway автоматически устанавливает переменную `PORT`
- Убедитесь что в `railway.json` используется `$PORT`
- Проверьте что команда запуска: `uvicorn main:app --host 0.0.0.0 --port $PORT`

### 3. Ошибка с базой данных

**Проблема**: Не может подключиться к БД

**Решение**:
- Убедитесь что PostgreSQL сервис добавлен в Railway
- Скопируйте `DATABASE_URL` из настроек PostgreSQL
- Добавьте `DATABASE_URL` в переменные окружения бэкенда
- Формат должен быть: `postgresql://user:password@host:port/dbname`

### 4. Ошибка с зависимостями

**Проблема**: Не может установить пакеты

**Решение**:
- Проверьте что `requirements.txt` находится в `backend/`
- Убедитесь что все зависимости указаны в `requirements.txt`
- Проверьте логи сборки в Railway

### 5. Ошибка с ffmpeg

**Проблема**: Whisper не может работать без ffmpeg

**Решение**:
- Если используете Dockerfile, ffmpeg уже установлен
- Если используете Nixpacks, Railway должен установить автоматически
- Проверьте логи если ffmpeg не найден

### 6. Файлы не сохраняются

**Проблема**: Загруженные файлы пропадают после перезапуска

**Решение**:
- Это нормально для Railway - файлы хранятся во временной файловой системе
- Для постоянного хранения используйте S3 или другой cloud storage
- Или используйте volume в Railway (платная функция)

## Проверка деплоя:

1. Проверьте health endpoint: `https://your-app.up.railway.app/health`
2. Проверьте основной endpoint: `https://your-app.up.railway.app/`
3. Проверьте API: `https://your-app.up.railway.app/api/calls`

## Логи:

Всегда проверяйте логи в Railway:
- Settings → View Logs
- Ищите ошибки при старте приложения
- Проверяйте ошибки подключения к БД

